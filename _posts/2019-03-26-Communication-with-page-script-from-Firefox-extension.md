---
title: Communication between page script and Firefox extension
published: true
---

### [](#header-3)The problem:\

Few days ago I wrote a [tool](automation-of-knoxss-extension) which automates Knoxss extension. In the beginning my tool was not able to communicate with extension so I couldn't read its status and so on. I had information generated by extension in background script and needed to receive it in page script and handle in Python. The problem was that every solution I found described communication from HTML page to extension but I needed something opposite. Second problem: I'm not a JavaScript programmer :)\

### Toolbelt:\

- geckodriver 0.23.0 ( 2018-10-04)
- Mozilla Firefox 67.0b4 Developer Edition
- Selenium 3.141.0
- KNOXSS Add-on 1.2.0
- Python 3.6.5

### What I found:\

I've found plenty of stackoverflow drips but it were to complicated for my problem or desribed communication in the opposite direction. 

1. [Communication between HTML and your extension](https://developer.mozilla.org/en-US/docs/Archive/Add-ons/Communication_between_HTML_and_your_extension) - described usage of Custom events which gave me an idea of trying it
2. [Can my webdriver script catch a event from the webpage](https://stackoverflow.com/questions/35884230/can-my-webdriver-script-catch-a-event-from-the-webpage) - Catching JavaScript events by Selenium Webdriver


### What I tried:\

1. Intercepting Console API entries in Selenium - [Support for Seleniumâ€™s logging interface](https://github.com/mozilla/geckodriver/issues/284) - didn't work for me
2. Communicating with alert box (editing extension code and add `alert(status)` somewhere in msgKnoxss function - possible but not elegant.\

### Some theory about extensions:\

There are three different types of JavaScript code when talking about extensions:

| Name  | Properties |
| ------------- | ------------- |
| Page script  | Code running in context of the web page  |
| Content script  | Part of the extension but running in context of the web page, proxy between page and background scripts  |
| Background script  | Logic of the extension, **could not** communicate with page script, what is my purpose  |

As mentioned [here](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#Communicating_with_background_scripts):
> There are two basic patterns for communicating between the background scripts and content scripts: you can send one-off messages, with an optional response, or you can set up a longer-lived connection between the two sides, and use that connection to exchange messages.
